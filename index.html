<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muslim Assistant - Ammar Ali</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #27ae60;
            --bg-color: #f4f7f6;
            --text-color: #333;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            display: flex;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- Sidebar --- */
        #sidebar {
            width: 260px;
            height: 100dvh;
            background: var(--primary-color);
            color: white;
            position: fixed;
            left: -260px;
            top: 0;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            z-index: 1001;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
            overflow-y: auto;
        }

        #sidebar.open { left: 0; }

        .sidebar-header {
            padding: 20px;
            font-size: 1.4em;
            font-weight: bold;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-item {
            padding: 18px 25px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: 0.2s;
        }

        .nav-item:hover { background: var(--accent-color); }

        .made-by {
            padding: 20px;
            font-size: 0.8em;
            text-align: center;
            opacity: 0.7;
            margin-top: auto;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* --- Main Content --- */
        #main-content {
            flex-grow: 1;
            padding: 20px;
            width: 100%;
            transition: 0.3s;
        }

        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .menu-btn {
            font-size: 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
        }

        .share-btn {
            background: white;
            border: 1px solid #ddd;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .share-btn img {
            width: 24px;
            height: 24px;
        }

        .page { display: none; max-width: 600px; margin: 0 auto; }
        .page.active { display: block; }

        .card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }

        /* --- UI Elements --- */
        input, select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: var(--accent-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        .btn-full { width: 100%; margin-top: 10px; }

        /* --- Namaz & Tables --- */
        .namaz-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .prayer-table { width: 100%; border-collapse: collapse; }
        .prayer-table td { padding: 12px; border-bottom: 1px solid #f0f0f0; }

        /* --- Tasbeeh Overlay --- */
        #active-counter {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 2000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .count-btn {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            font-size: 3em;
            background: var(--primary-color);
            color: white;
            border: 10px solid var(--accent-color);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .count-btn { width: 200px; height: 200px; font-size: 2.5em; }
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <div class="sidebar-header">
            <span>Menu</span>
            <span onclick="toggleSidebar()" style="cursor:pointer">‚úï</span>
        </div>
        <div class="nav-item" onclick="showPage('home')">üè† Home Dashboard</div>
        <div class="nav-item" onclick="showPage('tasbeeh')">üìø Smart Tasbeeh</div>
        <div class="nav-item" onclick="showPage('namaz')">üïå Namaz Tracker</div>
        <div class="nav-item" onclick="showPage('azkar')">‚òÄÔ∏è Daily Azkar</div>
        <div class="nav-item" onclick="showPage('settings')">‚öôÔ∏è Advanced Settings</div>
        <div class="nav-item" onclick="showPage('guide')">üìñ How to Use</div>
        <div class="made-by">made by Ammar Ali</div>
    </div>

    <div id="main-content">
        <div class="header-row">
            <button class="menu-btn" onclick="toggleSidebar()">‚ò∞</button>
            <div class="share-btn" onclick="shareApp()">
                <img src="share.png" alt="Share">
            </div>
        </div>

        <div id="home" class="page active">
            <div class="card" style="text-align:center;">
                <div id="hijri-date" style="color: var(--accent-color); font-weight: bold; font-size: 1.2em;">Wednesday, Sha ªban 23, 1447 AH</div>
                <div id="clock" style="font-size: 3em; font-weight: bold; margin: 10px 0;">00:00:00</div>
                <table class="prayer-table" id="home-prayer-list"></table>
                <button class="btn-full" style="background: #f39c12;" onclick="dailyReset()">Daily Reset Progress</button>
            </div>
        </div>

        <div id="tasbeeh" class="page">
            <div class="card">
                <h3>Add New Tasbeeh</h3>
                <input type="text" id="t-name" placeholder="Name (e.g. SubhanAllah)">
                <input type="number" id="t-goal" placeholder="Target Goal">
                <button class="btn-full" onclick="addTasbeeh()">Add Tasbeeh</button>
            </div>
            <div id="tasbeeh-list"></div>
        </div>

        <div id="namaz" class="page">
            <div class="card">
                <h2>Namaz Tracker</h2>
                <div id="namaz-items"></div>
                <hr>
                <h4>Add Extra (Nafl/Tahajjud)</h4>
                <input type="text" id="extra-name" placeholder="Prayer Name">
                <button class="btn-full" onclick="addExtraNamaz()">Add Prayer</button>
            </div>
        </div>

        <div id="azkar" class="page">
            <div class="card">
                <h3>Daily Azkar</h3>
                <input type="text" id="azkar-input" placeholder="Enter Azkar/Dua">
                <button class="btn-full" onclick="addAzkar()">Add to List</button>
            </div>
            <div id="azkar-list"></div>
        </div>

        <div id="settings" class="page">
            <div class="card">
                <h3>Theme Customization</h3>
                <label>Change App Color:</label>
                <input type="color" id="theme-picker" onchange="updateTheme(this.value)" style="height:50px;">
                
                <h3 style="margin-top:20px;">Adhan Settings</h3>
                <select id="adhan-select">
                    <option value="adhan1.mp3">Adhan Voice 1</option>
                    <option value="adhan2.mp3">Adhan Voice 2</option>
                    <option value="adhan3.mp3">Adhan Voice 3</option>
                </select>
                
                <h3>Edit Local Times</h3>
                <div id="edit-times"></div>
                <button class="btn-full" onclick="saveNewTimes()">Save Local Times</button>
            </div>
        </div>

	    <div id="guide" class="page">
            <div class="card">
                <h2>üìñ How to Use</h2>
                <h3>üì± Navigation & Menu</h3>
                <p>Tap ‚ò∞ Menu to switch pages. If the menu is too long on your phone, you can scroll down inside it. The app is signed <b>"made by Ammar Ali"</b> at the bottom.</p>
                
                <h3>üìø Tasbeeh Counter</h3>
                <p><b>Adding:</b> Type the name and goal. <b>Counting:</b> Tap your Tasbeeh to open the large "COUNT" button. <b>Goal Sound:</b> A sound plays ONLY when you hit your target. <b>Auto Mode:</b> Taps for you every 2 seconds.</p>
                
                <h3>üïå Adhan System</h3>
                <p>The app plays Adhan automatically at the set times. Use <b>Settings</b> to preview voices or manually adjust Fajr, Dhuhr, etc., times to match your mosque.</p>
                
                <h3>üè† Home Dashboard</h3>
                <p>View your Hijri date and live clock here. Use <b>Reset Daily Progress</b> to set your counters back to zero for a new day without deleting your Tasbeeh names.</p>
            </div>
        </div>
    </div>

    <div id="active-counter">
        <h2 id="active-t-name">Tasbeeh</h2>
        <h1 id="active-t-count" style="font-size: 5em; margin: 20px 0;">0</h1>
        <button class="count-btn" onclick="incrementCount()">COUNT</button>
        <div style="margin-top: 30px; display:flex; gap:10px;">
            <button onclick="toggleAutoMode()" id="auto-btn" style="background:#3498db">Auto Mode</button>
            <button onclick="closeCounter()" style="background:#e74c3c">Save & Close</button>
        </div>
    </div>

    <script>
        let data = JSON.parse(localStorage.getItem('muslimAppData')) || {
            theme: '#27ae60',
            prayers: [
                {name: 'Fajr', time: '05:35', done: false, type: 'farz'},
                {name: 'Dhuhr', time: '12:28', done: false, type: 'farz'},
                {name: 'Asr', time: '16:15', done: false, type: 'farz'},
                {name: 'Maghrib', time: '17:55', done: false, type: 'farz'},
                {name: 'Isha', time: '19:15', done: false, type: 'farz'}
            ],
            tasbeehs: [],
            azkars: []
        };

        let activeIdx = null;
        let autoTimer = null;

        function save() { localStorage.setItem('muslimAppData', JSON.stringify(data)); }

        function shareApp() {
            if (navigator.share) {
                navigator.share({ title: 'Muslim Assistant', text: 'Check out this app made by Ammar Ali!', url: window.location.href });
            } else {
                alert("Link copied to clipboard: " + window.location.href);
            }
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }
        
        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(id === 'namaz') renderNamaz();
            if(id === 'tasbeeh') renderTasbeehs();
            if(id === 'azkar') renderAzkar();
            if(id === 'settings') renderSettings();
            if(window.innerWidth < 768) toggleSidebar();
        }

        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-GB');
            document.getElementById('clock').innerText = timeStr;
            if(now.getSeconds() === 0) {
                const cur = timeStr.substring(0, 5);
                data.prayers.forEach(p => { if(p.time === cur) new Audio(document.getElementById('adhan-select').value).play().catch(()=>{}); });
            }
        }
        setInterval(updateClock, 1000);

        function renderNamaz() {
            const container = document.getElementById('namaz-items');
            container.innerHTML = data.prayers.map((p, i) => `
                <div class="namaz-row">
                    <span>${p.name} ${p.type==='extra'?'(Extra)':''}</span>
                    <div>
                        <input type="checkbox" style="width:25px; height:25px;" ${p.done?'checked':''} onchange="data.prayers[${i}].done=!data.prayers[${i}].done; save()">
                        ${p.type==='extra'? `<button onclick="deleteExtra(${i})" style="background:red; padding:2px 8px; margin-left:10px;">X</button>` : ''}
                    </div>
                </div>
            `).join('');
            document.getElementById('home-prayer-list').innerHTML = data.prayers.filter(p=>p.type==='farz').map(p=>`<tr><td>${p.name}</td><td align="right">${p.time}</td></tr>`).join('');
        }

        function addExtraNamaz() {
            const name = document.getElementById('extra-name').value;
            if(name) { data.prayers.push({name, time: '--:--', done: false, type: 'extra'}); save(); renderNamaz(); document.getElementById('extra-name').value=''; }
        }
        function deleteExtra(i) { data.prayers.splice(i,1); save(); renderNamaz(); }

        function renderTasbeehs() {
            const list = document.getElementById('tasbeeh-list');
            list.innerHTML = data.tasbeehs.map((t, i) => `
                <div class="card" onclick="openCounter(${i})" style="display:flex; justify-content:space-between; align-items:center;">
                    <b>${t.name}</b>
                    <span>${t.count} / ${t.goal}</span>
                    <button onclick="deleteTasbeeh(${i}, event)" style="background:red;">Delete</button>
                </div>`).join('');
        }
        function addTasbeeh() {
            const name = document.getElementById('t-name').value, goal = document.getElementById('t-goal').value;
            if(name && goal) { data.tasbeehs.push({name, goal, count: 0}); save(); renderTasbeehs(); document.getElementById('t-name').value=''; document.getElementById('t-goal').value=''; }
        }
        function openCounter(i) {
            activeIdx = i;
            document.getElementById('active-t-name').innerText = data.tasbeehs[i].name;
            document.getElementById('active-t-count').innerText = data.tasbeehs[i].count;
            document.getElementById('active-counter').style.display = 'flex';
        }
        function incrementCount() {
            data.tasbeehs[activeIdx].count++;
            document.getElementById('active-t-count').innerText = data.tasbeehs[activeIdx].count;
            if(data.tasbeehs[activeIdx].count == data.tasbeehs[activeIdx].goal) { alert("Goal Reached!"); if(autoTimer) toggleAutoMode(); }
        }
        function toggleAutoMode() {
            const btn = document.getElementById('auto-btn');
            if(autoTimer) { clearInterval(autoTimer); autoTimer = null; btn.innerText = "Auto Mode"; btn.style.background = "#3498db"; }
            else { autoTimer = setInterval(incrementCount, 2000); btn.innerText = "STOP AUTO"; btn.style.background = "red"; }
        }
        function closeCounter() { if(autoTimer) toggleAutoMode(); save(); renderTasbeehs(); document.getElementById('active-counter').style.display = 'none'; }
        function deleteTasbeeh(i, e) { e.stopPropagation(); data.tasbeehs.splice(i, 1); save(); renderTasbeehs(); }

        function renderAzkar() {
            document.getElementById('azkar-list').innerHTML = data.azkars.map((a, i) => `<div class="card" style="display:flex; justify-content:space-between;"><span>${a}</span><button onclick="data.azkars.splice(${i},1); save(); renderAzkar();" style="background:red">X</button></div>`).join('');
        }
        function addAzkar() {
            const val = document.getElementById('azkar-input').value;
            if(val) { data.azkars.push(val); document.getElementById('azkar-input').value=''; save(); renderAzkar(); }
        }

        function renderSettings() {
            document.getElementById('edit-times').innerHTML = data.prayers.filter(p=>p.type==='farz').map((p, i) => `<div style="display:flex; justify-content:space-between; margin-bottom:5px;"><span>${p.name}</span><input type="time" id="time-${i}" value="${p.time}" style="width:120px;"></div>`).join('');
            document.getElementById('theme-picker').value = data.theme;
        }
        function saveNewTimes() {
            data.prayers.filter(p=>p.type==='farz').forEach((p, i) => { p.time = document.getElementById(`time-${i}`).value; });
            save(); renderNamaz(); alert("Settings Saved!");
        }
        function updateTheme(color) { data.theme = color; document.documentElement.style.setProperty('--primary-color', color); save(); }
        function dailyReset() { if(confirm("Reset progress?")) { data.prayers.forEach(p=>p.done=false); data.tasbeehs.forEach(t=>t.count=0); save(); renderNamaz(); renderTasbeehs(); } }

        document.documentElement.style.setProperty('--primary-color', data.theme);
        renderNamaz();
        renderTasbeehs();
        renderAzkar();
    </script>
</body>
</html>
